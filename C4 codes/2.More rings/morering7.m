clc;clear;close all;

N4= 4 ;
th4 = 2*pi/(N4*6):2*pi/(N4*6):2*pi;
n4=length(th4);
r4 = 4*ones(n4,1)';
act4 = zeros(1,n4);
life4=zeros(1,n4);

N5= 5 ;
th5 = 2*pi/(N5*6):2*pi/(N5*6):2*pi;
n5=length(th5);
r5 = 5*ones(n5,1)';
act5 = zeros(1,n5);
life5=zeros(1,n5);

N6= 6;
th6 = 2*pi/(N6*6):2*pi/(N6*6):2*pi;
n6=length(th6);
r6 = 6*ones(n6,1)';
act6 = zeros(1,n6);
life6=zeros(1,n6);

N7= 7 ;
th7 = 2*pi/(N7*6):2*pi/(N7*6):2*pi;
n7=length(th7);
r7 = 7*ones(n7,1)';
act7 = zeros(1,n7);
life7=zeros(1,n7);

N8= 8;
th8 = 2*pi/(N8*6):2*pi/(N8*6):2*pi;
n8=length(th8);
r8 =8*ones(n8,1)';
act8 = zeros(1,n8);
life8=zeros(1,n8);

N9= 9 ;
th9 = 2*pi/(N9*6):2*pi/(N9*6):2*pi;
n9=length(th9);
r9 =9*ones(n9,1)';
act9 = zeros(1,n9);
life9=zeros(1,n9);

N10= 10;
th10 = 2*pi/(N10*6):2*pi/(N10*6):2*pi;
n10=length(th10);
r10 =10*ones(n10,1)';
act10 = zeros(1,n10);
life10=zeros(1,n10);

N11= 11;
th11 = 2*pi/(N11*6):2*pi/(N11*6):2*pi;
n11=length(th11);
r11 =11*ones(n11,1)';
act11 = zeros(1,n11);
life11=zeros(1,n11);

N12= 12;
th12 = 2*pi/(N12*6):2*pi/(N12*6):2*pi;
n12=length(th12);
r12 =12*ones(n12,1)';
act12 = zeros(1,n12);
life12=zeros(1,n12);

N13= 13;
th13 = 2*pi/(N13*6):2*pi/(N13*6):2*pi;
n13=length(th13);
r13 =13*ones(n13,1)';
act13 = zeros(1,n13);
life13=zeros(1,n13);

N14=14;
th14 = 2*pi/(N14*6):2*pi/(N14*6):2*pi;
n14=length(th14);
r14 =14*ones(n14,1)';
act14 = zeros(1,n14);
life14=zeros(1,n14);

N15=15;
th15 = 2*pi/(N15*6):2*pi/(N15*6):2*pi;
n15=length(th15);
r15 =15*ones(n15,1)';
act15 = zeros(1,n15);
life15=zeros(1,n15);

N16=16;
th16 = 2*pi/(N16*6):2*pi/(N16*6):2*pi;
n16=length(th16);
r16 =16*ones(n16,1)';
act16 = zeros(1,n16);
life16=zeros(1,n16);

N17=17;
th17 = 2*pi/(N17*6):2*pi/(N17*6):2*pi;
n17=length(th17);
r17 =17*ones(n17,1)';
act17 = zeros(1,n17);
life17=zeros(1,n17);

N18=18;
th18 = 2*pi/(N18*6):2*pi/(N18*6):2*pi;
n18=length(th18);
r18 =18*ones(n18,1)';
act18 = zeros(1,n18);
life18=zeros(1,n18);

N19=19;
th19 = 2*pi/(N19*6):2*pi/(N19*6):2*pi;
n19=length(th19);
r19 =19*ones(n19,1)';
act19 = zeros(1,n19);
life19=zeros(1,n19);

N20=20;
th20 = 2*pi/(N20*6):2*pi/(N20*6):2*pi;
n20=length(th20);
r20 =20*ones(n20,1)';
act20 = zeros(1,n20);
life20=zeros(1,n20);

N21=21;
th21 = 2*pi/(N21*6):2*pi/(N21*6):2*pi;
n21=length(th21);
r21 =21*ones(n21,1)';
act21 = zeros(1,n21);
life21=zeros(1,n21);

N22=22;
th22 = 2*pi/(N22*6):2*pi/(N22*6):2*pi;
n22=length(th22);
r22 =22*ones(n22,1)';
act22 = zeros(1,n22);
life22=zeros(1,n22);

N23=23;
th23 = 2*pi/(N23*6):2*pi/(N23*6):2*pi;
n23=length(th23);
r23 =23*ones(n23,1)';
act23 = zeros(1,n23);
life23=zeros(1,n23);

N24=24;
th24 = 2*pi/(N24*6):2*pi/(N24*6):2*pi;
n24=length(th24);
r24 =24*ones(n24,1)';
act24 = zeros(1,n24);
life24=zeros(1,n24);

N25=25;
th25 = 2*pi/(N25*6):2*pi/(N25*6):2*pi;
n25=length(th25);
r25 =25*ones(n25,1)';
act25 = zeros(1,n25);
life25=zeros(1,n25);

N26=26;
th26 = 2*pi/(N26*6):2*pi/(N26*6):2*pi;
n26=length(th26);
r26 =26*ones(n26,1)';
act26 = zeros(1,n26);
life26=zeros(1,n26);

N27=27;
th27 = 2*pi/(N27*6):2*pi/(N27*6):2*pi;
n27=length(th27);
r27 =27*ones(n27,1)';
act27 = zeros(1,n27);
life27=zeros(1,n27);

N28=28;
th28 = 2*pi/(N28*6):2*pi/(N28*6):2*pi;
n28=length(th28);
r28 =28*ones(n28,1)';
act28 = zeros(1,n28);
life28=zeros(1,n28);

N29=29;
th29 = 2*pi/(N29*6):2*pi/(N29*6):2*pi;
n29=length(th29);
r29 =29*ones(n29,1)';
act29 = zeros(1,n29);
life29=zeros(1,n29);

N30=30;
th30 = 2*pi/(N30*6):2*pi/(N30*6):2*pi;
n30=length(th30);
r30 =30*ones(n30,1)';
act30 = zeros(1,n30);
life30=zeros(1,n30);

N31=31;
th31 = 2*pi/(N31*6):2*pi/(N31*6):2*pi;
n31=length(th31);
r31 =31*ones(n31,1)';
act31 = zeros(1,n31);
life31=zeros(1,n31);

N32=32;
th32 = 2*pi/(N32*6):2*pi/(N32*6):2*pi;
n32=length(th32);
r32 =32*ones(n32,1)';
act32 = zeros(1,n32);
life32=zeros(1,n32);

N33=33;
th33 = 2*pi/(N33*6):2*pi/(N33*6):2*pi;
n33=length(th33);
r33 =33*ones(n33,1)';
act33 = zeros(1,n33);
life33=zeros(1,n33);

N34=34;
th34 = 2*pi/(N34*6):2*pi/(N34*6):2*pi;
n34=length(th34);
r34 =34*ones(n34,1)';
act34 = zeros(1,n34);
life34=zeros(1,n34);

N35=35;
th35 = 2*pi/(N35*6):2*pi/(N35*6):2*pi;
n35=length(th35);
r35 =35*ones(n35,1)';
act35 = zeros(1,n35);
life35=zeros(1,n35);

N36=36;
th36 = 2*pi/(N36*6):2*pi/(N36*6):2*pi;
n36=length(th36);
r36 =36*ones(n36,1)';
act36 = zeros(1,n36);
life36=zeros(1,n36);

N37=37;
th37 = 2*pi/(N37*6):2*pi/(N37*6):2*pi;
n37=length(th37);
r37 =37*ones(n37,1)';
act37 = zeros(1,n37);
life37=zeros(1,n37);

N38=38;
th38 = 2*pi/(N38*6):2*pi/(N38*6):2*pi;
n38=length(th38);
r38 =38*ones(n38,1)';
act38 = zeros(1,n38);
life38=zeros(1,n38);

N39=39;
th39 = 2*pi/(N39*6):2*pi/(N39*6):2*pi;
n39=length(th39);
r39 =39*ones(n39,1)';
act39 = zeros(1,n39);
life39=zeros(1,n39);

N40=40;
th40 = 2*pi/(N40*6):2*pi/(N40*6):2*pi;
n40=length(th40);
r40 =40*ones(n40,1)';
act40 = zeros(1,n40);
life40=zeros(1,n40);

N41=41;
th41 = 2*pi/(N41*6):2*pi/(N41*6):2*pi;
n41=length(th41);
r41 =41*ones(n41,1)';
act41 = zeros(1,n41);
life41=zeros(1,n41);

N42=42;
th42 = 2*pi/(N42*6):2*pi/(N42*6):2*pi;
n42=length(th42);
r42 =42*ones(n42,1)';
act42 = zeros(1,n42);
life42=zeros(1,n42);

N43=43;
th43 = 2*pi/(N43*6):2*pi/(N43*6):2*pi;
n43=length(th43);
r43 =43*ones(n43,1)';
act43 = zeros(1,n43);
life43=zeros(1,n43);

N44=44;
th44 = 2*pi/(N44*6):2*pi/(N44*6):2*pi;
n44=length(th44);
r44 =44*ones(n44,1)';
act44 = zeros(1,n44);
life44=zeros(1,n44);

N45=45;
th45 = 2*pi/(N45*6):2*pi/(N45*6):2*pi;
n45=length(th45);
r45 =45*ones(n45,1)';
act45 = zeros(1,n45);
life45=zeros(1,n45);

N46=46;
th46 = 2*pi/(N46*6):2*pi/(N46*6):2*pi;
n46=length(th46);
r46 =46*ones(n46,1)';
act46 = zeros(1,n46);
life46=zeros(1,n46);

N47=47;
th47 = 2*pi/(N47*6):2*pi/(N47*6):2*pi;
n47=length(th47);
r47 =47*ones(n47,1)';
act47 = zeros(1,n47);
life47=zeros(1,n47);

N48=48;
th48 = 2*pi/(N48*6):2*pi/(N48*6):2*pi;
n48=length(th48);
r48 =48*ones(n48,1)';
act48 = zeros(1,n48);
life48=zeros(1,n48);

N49=49;
th49 = 2*pi/(N49*6):2*pi/(N49*6):2*pi;
n49=length(th49);
r49 =49*ones(n49,1)';
act49 = zeros(1,n49);
life49=zeros(1,n49);

N50=50;
th50 = 2*pi/(N50*6):2*pi/(N50*6):2*pi;
n50=length(th50);
r50 =50*ones(n50,1)';
act50 = zeros(1,n50);
life50=zeros(1,n50);

n=n4+n5+n6+n7+n8+n9+n10+n11+n12+n13+n14+n15+n16+n17+n18+n19+n20+n21+n22+n23+n24+n25+n26+n27+n28+n29+n30+n31+n32+n33+n34+n35+n36+n37+n38+n39+n40+n41+n42+n43+n44+n45+n46+n47+n48+n49+n50;
sand_pile = [th4 th5 th6 th7 th8 th9 th10 th11 th12 th13 th14 th15 th16 th17 th18 th19 th20 th21 th22 th23 th24 th25 th26 th27 th28 th29 th30 th31 th32 th33 th34 th35 th36 th37 th38 th39 th40 th41 th42 th43 th44 th45 th46 th47 th48 th49 th50;r4 r5 r6 r7 r8 r9 r10 r11 r12 r13 r14 r15 r16 r17 r18 r19 r20 r21 r22 r23 r24 r25 r26 r27 r28 r29 r30 r31 r32 r33 r34 r35 r36 r37 r38 r39 r40 r41 r42 r43 r44 r45 r46 r47 r48 r49 r50; zeros(1,n) ];
active_matrix = [th4 th5 th6 th7 th8 th9 th10 th11 th12 th13 th14 th15 th16 th17 th18 th19 th20 th21 th22 th23 th24 th25 th26 th27 th28 th29 th30 th31 th32 th33 th34 th35 th36 th37 th38 th39 th40 th41 th42 th43 th44 th45 th46 th47 th48 th49 th50;r4 r5 r6 r7 r8 r9 r10 r11 r12 r13 r14 r15 r16 r17 r18 r19 r20 r21 r22 r23 r24 r25 r26 r27 r28 r29 r30 r31 r32 r33 r34 r35 r36 r37 r38 r39 r40 r41 r42 r43 r44 r45 r46 r47 r48 r49 r50; act4 act5 act6 act7 act8 act9 act10 act11 act12 act13 act14 act15 act16 act17 act18 act19 act20 act21 act22 act23 act24 act25 act26 act27 act28 act29 act30 act31 act32 act33 act34 act35 act36 act37 act38 act39 act40 act41 act42 act43 act44 act45 act46 act47 act48 act49 act50];
life_time = [th4 th5 th6 th7 th8 th9 th10 th11 th12 th13 th14 th15 th16 th17 th18 th19 th20 th21 th22 th23 th24 th25 th26 th27 th28 th29 th30 th31 th32 th33 th34 th35 th36 th37 th38 th39 th40 th41 th42 th43 th44 th45 th46 th47 th48 th49 th50;r4 r5 r6 r7 r8 r9 r10 r11 r12 r13 r14 r15 r16 r17 r18 r19 r20 r21 r22 r23 r24 r25 r26 r27 r28 r29 r30 r31 r32 r33 r34 r35 r36 r37 r38 r39 r40 r41 r42 r43 r44 r45 r46 r47 r48 r49 r50; life4 life5 life6 life7 life8 life9 life10 life11 life12 life13 life14 life15 life16 life17 life18 life19 life20 life21 life22 life23 life24 life25 life26 life27 life28 life29 life30 life31 life32 life33 life34 life35 life36 life37 life38 life39 life40 life41 life42 life43 life44 life45 life46 life47 life48 life49 life50];
history = [th4 th5 th6 th7 th8 th9 th10 th11 th12 th13 th14 th15 th16 th17 th18 th19 th20 th21 th22 th23 th24 th25 th26 th27 th28 th29 th30 th31 th32 th33 th34 th35 th36 th37 th38 th39 th40 th41 th42 th43 th44 th45 th46 th47 th48 th49 th50;r4 r5 r6 r7 r8 r9 r10 r11 r12 r13 r14 r15 r16 r17 r18 r19 r20 r21 r22 r23 r24 r25 r26 r27 r28 r29 r30 r31 r32 r33 r34 r35 r36 r37 r38 r39 r40 r41 r42 r43 r44 r45 r46 r47 r48 r49 r50; zeros(1,n) ];
number_sand = 200;
p_sp=0.1;
p_st=0.8;
p_st_c=0.1;
lifetime=100;


interval=1; % every few sand drops polt a graph.
frames(number_sand/interval)=struct('cdata',[],'colormap',[]);
bb=1; %index of images



regeneration_time_1 = 11; % dropping regerneration time
regeneration_time_2 = 11; % topping regerneration time
shorest_number = 6;
add_number=2;
add_number_induce=1;

choose_p = 1;
ZC = 1; % critical values


v4=1;
v5=1;
v6=1;
v7=1;
v8=1;
v9=2;
v10=2;
v11=2;
v12=2;
v13=2;
v14=2;
v15=3;
v16=3;
v17=3;
v18=3;
v19=3;
v20=3;
v21=3;
v22=3;
v23=3;
v24=3;
v25=3;
v26=3;
v27=3;
v28=3;
v29=3;
v30=3;
v31=3;
v32=3;
v33=3;
v34=3;
v35=3;
v36=3;
v37=3;
v38=3;
v39=3;
v40=3;
v41=3;
v42=3;
v43=3;
v44=3;
v45=3;
v46=3;
v47=3;
v48=3;
v49=3;
v50=3;

timesteps=0;

for i=1:number_sand
    timesteps=timesteps+1;
    pause(0.1);
   
    [in_active_position] = find(active_matrix(3,:) > 0);
    in_act = length(in_active_position);
    for g=1:in_act
       active_matrix(3,in_active_position(g)) = active_matrix(3,in_active_position(g)) - 1; 
    end

    [life_position] = find(life_time(3,:) > 1);
    for gg=1:length(life_position)
       life_time(3,life_position(gg)) = life_time(3,life_position(gg)) - 1; 
    end

    [death_position] = find(life_time(3,:) == 1);
    for ggg=1:length(death_position)
       sand_pile(3,death_position(ggg)) = 0;
    end

    
    [active_position] = find(active_matrix(3,:) == 0);
    act = length(active_position);
    active_position = active_position(1:round(act-1));
    %partial_active = active_position(1:round(0.7*act));
    act = length(active_position);
    %act = length(partial_active);

    %r_choose = randi([4 50]);
    r_canbe = active_matrix(2,active_position);
    r_no_repeat = unique(r_canbe);
    r_choose = r_no_repeat(randperm(numel(r_no_repeat),1));
    [r_exist] = find(active_matrix(3,:) == r_choose);


    randomNUM = round(1+rand(1,1)*(length(r_exist)));
    index_now = active_position(randomNUM);


    active_or_not = rand;
    if active_or_not <= p_sp
        sand_pile(3,index_now) = sand_pile(3,index_now) + add_number;
        active_matrix(3,index_now) = active_matrix(3,index_now) + regeneration_time_1;
        life_time(3,index_now) = life_time(3,index_now) + lifetime;
    end

    
    [position_tops] = find( sand_pile(3,:) > ZC-1);
    number_top = length(position_tops);
    while number_top > 0
        for j = 1: number_top
            sand_pile(3,position_tops(j)) = sand_pile(3,position_tops(j)) - (ZC+1);
            theta_top_now  = sand_pile(1,position_tops(j));
            radius_top_now = sand_pile(2,position_tops(j));
            active_matrix(3,position_tops(j)) = active_matrix(3,position_tops(j)) + regeneration_time_2;
            
            radius1 = gpuArray(radius_top_now);
            theta1  = gpuArray(rad2deg(theta_top_now));
            radius2 = gpuArray(sand_pile(2,:));
            theta2  = gpuArray(rad2deg(sand_pile(1,:)));
            
            radius1_square=radius1^2;
            radius1_new = ones(1,length(radius2))*radius1_square;
            d_square_gpu = radius1_new + radius2.^2 - (2 * radius1 * radius2 .* cos(theta1 - theta2));
            d = d_square_gpu;
            
            [B,I] = mink(d,shorest_number);
            z = length(I);
            
            % need to check if active
            [active_position] = find(active_matrix(3,:) == 0);
            
            for q=2:z
                if ismember(I(q),active_position)==1
                    active_or_not2 = rand;
                    active_or_not3 = rand;
                    if active_or_not2 <= p_st && sand_pile(2,I(q)) ~= radius_top_now
                       sand_pile(3,I(q)) = sand_pile(3,I(q)) + add_number_induce;
                       active_matrix(3,I(q)) = active_matrix(3,I(q)) + regeneration_time_2;
                       life_time(3,I(q)) = life_time(3,I(q)) + lifetime;
                    elseif active_or_not3 <= p_st_c && sand_pile(2,I(q)) == radius_top_now
                       sand_pile(3,I(q)) = sand_pile(3,I(q)) + add_number_induce;
                       active_matrix(3,I(q)) = active_matrix(3,I(q)) + regeneration_time_2 + 1;
                       life_time(3,I(q)) = life_time(3,I(q)) + lifetime;
                    end
                end
            end    
        end        
        [position_tops] = find( sand_pile(3,:) > ZC );
        number_top = length(position_tops);
     end

[exist_position]=find(sand_pile(3,:)>0);
s = 20*sand_pile(3,exist_position);


[exist_position1]=find(history(3,:)>0);
s1 = 20*history(3,exist_position1);

if mod(i,interval)==0 
        polarscatter(sand_pile(1,exist_position),sand_pile(2,exist_position),s,sand_pile(3,exist_position),"x");
        hold on
        polarscatter(history(1,exist_position1),history(2,exist_position1),s1,history(3,exist_position1),"o");
        hold off
        colormap(flipud(gray))
        h=colorbar;
        rlim([0 55])
        axis off
        graphsetting([0.2 0.1 0.6 0.8]);  
        axis off
        title(['number of sand: ',sprintf('%d',i)])
        drawnow;
        check_point_here1 = mod(timesteps,2);
        
        frames(bb) = getframe(gcf);
        bb=bb+1;
end
history = sand_pile;

    th4=circshift(th4,[0,v4]);
    th5=circshift(th5,[0,v5]);
    th6=circshift(th6,[0,v6]);
    th7=circshift(th7,[0,v7]);
    th8=circshift(th8,[0,v8]);
    th9=circshift(th9,[0,v9]);
    th10=circshift(th10,[0,v10]);
    th11=circshift(th11,[0,v11]);
    th12=circshift(th12,[0,v12]);
    th13=circshift(th13,[0,v13]);
    th14=circshift(th14,[0,v14]);
    th15=circshift(th15,[0,v15]);
    th16=circshift(th16,[0,v16]);
    th17=circshift(th17,[0,v17]);
    th18=circshift(th18,[0,v18]);
    th19=circshift(th19,[0,v19]);
    th20=circshift(th20,[0,v20]);
    th21=circshift(th21,[0,v21]);
    th22=circshift(th22,[0,v22]);
    th23=circshift(th23,[0,v23]);
    th24=circshift(th24,[0,v24]);
    th25=circshift(th25,[0,v25]);
    th26=circshift(th26,[0,v26]);
    th27=circshift(th27,[0,v27]);
    th28=circshift(th28,[0,v28]);
    th29=circshift(th29,[0,v29]);
    th30=circshift(th30,[0,v30]);
    th31=circshift(th31,[0,v31]);
    th32=circshift(th32,[0,v32]);
    th33=circshift(th33,[0,v33]);
    th34=circshift(th34,[0,v34]);
    th35=circshift(th35,[0,v35]);
    th36=circshift(th36,[0,v36]);
    th37=circshift(th37,[0,v37]);
    th38=circshift(th38,[0,v38]);
    th39=circshift(th39,[0,v39]);
    th40=circshift(th40,[0,v40]);
    th41=circshift(th41,[0,v41]);
    th42=circshift(th42,[0,v42]);
    th43=circshift(th43,[0,v43]);
    th44=circshift(th44,[0,v44]);
    th45=circshift(th45,[0,v45]);
    th46=circshift(th46,[0,v46]);
    th47=circshift(th47,[0,v47]);
    th48=circshift(th48,[0,v48]);
    th49=circshift(th49,[0,v49]);
    th50=circshift(th50,[0,v50]);

   
    
    %position now.
    sand_pile(1,:)=[th4 th5 th6 th7 th8 th9 th10 th11 th12 th13 th14 th15 th16 th17 th18 th19 th20 th21 th22 th23 th24 th25 th26 th27 th28 th29 th30 th31 th32 th33 th34 th35 th36 th37 th38 th39 th40 th41 th42 th43 th44 th45 th46 th47 th48 th49 th50];
    active_matrix(1,:)=[th4 th5 th6 th7 th8 th9 th10 th11 th12 th13 th14 th15 th16 th17 th18 th19 th20 th21 th22 th23 th24 th25 th26 th27 th28 th29 th30 th31 th32 th33 th34 th35 th36 th37 th38 th39 th40 th41 th42 th43 th44 th45 th46 th47 th48 th49 th50];
    life_time(1,:)=[th4 th5 th6 th7 th8 th9 th10 th11 th12 th13 th14 th15 th16 th17 th18 th19 th20 th21 th22 th23 th24 th25 th26 th27 th28 th29 th30 th31 th32 th33 th34 th35 th36 th37 th38 th39 th40 th41 th42 th43 th44 th45 th46 th47 th48 th49 th50];
        sand_pile(2,:)=[ r4 r5 r6 r7 r8 r9 r10 r11 r12 r13 r14 r15 r16 r17 r18 r19 r20 r21 r22 r23 r24 r25 r26 r27 r28 r29 r30 r31 r32 r33 r34 r35 r36 r37 r38 r39 r40 r41 r42 r43 r44 r45 r46 r47 r48 r49 r50];
        sand_pile(2,:)=[ r4 r5 r6 r7 r8 r9 r10 r11 r12 r13 r14 r15 r16 r17 r18 r19 r20 r21 r22 r23 r24 r25 r26 r27 r28 r29 r30 r31 r32 r33 r34 r35 r36 r37 r38 r39 r40 r41 r42 r43 r44 r45 r46 r47 r48 r49 r50];
        sand_pile(2,:)=[ r4 r5 r6 r7 r8 r9 r10 r11 r12 r13 r14 r15 r16 r17 r18 r19 r20 r21 r22 r23 r24 r25 r26 r27 r28 r29 r30 r31 r32 r33 r34 r35 r36 r37 r38 r39 r40 r41 r42 r43 r44 r45 r46 r47 r48 r49 r50];
    
end

Video = VideoWriter('galaxy','MPEG-4');
open(Video);
writeVideo(Video,frames)
close(Video);

function graphsetting(setting)
    set(0,'units','centimeters') % we want to get unit in cm.
    computerscreensize=get(0,'screensize');  
    Length = computerscreensize(3); %length of computer screen
    Height = computerscreensize(4); %height of computer screen
    position=[setting(1)*Length setting(2)*Height setting(3)*Length setting(4)*Height];
    set(gcf,'units','centimeters','position',position); %Set the position & size of graph.
end

